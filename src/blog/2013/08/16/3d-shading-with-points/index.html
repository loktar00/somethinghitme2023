<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charSet="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="icon" href="/assets/favicon-32x32.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@100;400;700&display=swap');
    </style>
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="apple-touch-icon" sizes="48x48" href="/assets/icons/icon-48x48.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="96x96" href="/assets/icons/icon-96x96.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/assets/icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="256x256" href="/assets/icons/icon-256x256.png">
    <link rel="apple-touch-icon" sizes="384x384" href="/assets/icons/icon-384x384.png">
    <link rel="apple-touch-icon" sizes="512x512" href="/assets/icons/icon-512x512.png">
    <link href="/styles/styles.css" rel="stylesheet" />
    <link href="/styles/prism.css" rel="stylesheet" />
    <script type='module' src='/js/starscape.js'></script>
    <script src='/js/prism.js'></script>
    <title>3d Shading with Points - Somethinghitme</title>
</head>  <body>
    <div class="layout">
        <header class="header">
    <h1><a aria-current="page" href="/">Somethinghitme</a></h1>
    <h2>Code, demos and ideas.</h2>
</header>        <main class="main">
            <section class="primary">
                <article class="blog-post">
                    <header>
                        <h3>3d Shading with Points</h3>
                        <p>
                            Saturday, Aug 17, 2013                        </p>
                    </header>
                    <section>
                        <p>I was checking out some old books the other day and I came across Commodore Step by Step Graphics Vol 3. It had an interesting looking screenshot for a bit of code, which showed shaded spheres entirely made of points. I thought the effect would look cool if multiple ones were layered over each other to look like planets and moons. So I converted the Basic over to JavaScript using the canvas element to replicate the effect.</p>
<p>This is what is produced with the code.</p>
<p><a href="http://www.somethinghitme.com/wp-content/uploads/2013/08/Planets-with-points-CodePen.png"><img src="/src/blog/2013/08/16/3d-shading-with-points/images/Planets-with-points-CodePen.png" alt="Planets with points - CodePen" /></a></p>
<p>So how exactly is this effect achieved?</p>
<p><a href="http://cdpn.io/zEhDB">Full page result on codepen</a></p>
<p>The following function is what's used to generate the planets.</p>
<pre><code class="javascript language-javascript">    function drawPlanet(rad, xc, yc, color) {
        color = color || { r: 0, g: 100, b: 160 };
        ctx.fillStyle = "#000"; ctx.beginPath();
        ctx.arc(xc, yc, rad, 0, Math.PI \* 2); c
        tx.fill();
        ctx.closePath();

        ctx.fillStyle = "rgb(" + color.r + "," + color.g + "," + color.b + ")";

        var x1 = parseInt(Math.sqrt(rad * rad - y * y));
        for (var x = -x1; x &lt; x1; x++) {
            var n = parseInt(Math.random() * x1) / 1.5;
            if (n &gt; x1 + x) {
                ctx.fillRect(x + xc, y + yc, 1, 1);
            }
        }
    }
</code></pre>
<p>The function drawPlanet takes four parameters. Radius, center x, center y, and the color of the planet. First a solid black arc is created so we can get a proper layering effect, otherwise dots would bleed through and the planets would blend together.</p>
<p>The loop from -rad to rad is where everything takes place. Each iteration as we go down the circle we find out how long the row is from the center x and y position to the edge of the circle. Thanks to <a href="https://twitter.com/yutt">@yutt</a> for pointing me in the right direction.</p>
<p>We have two points to go from, our Radius (center point), and the Y. So using Pythagoras Theorem (a^2 + b^2 = c^2) we have a and c we can figure out b.</p>
<p><a href="http://www.somethinghitme.com/wp-content/uploads/2013/08/radfig1.png"><img src="/src/blog/2013/08/16/3d-shading-with-points/images/radfig1.png" alt="radfig1" /></a></p>
<p><a href="http://jsfiddle.net/loktar/yJhLu/">Try the fiddle out to see how it works.</a></p>
<p>We have the point from radius, radius+y to the edge of the circle. Now we are able to iterate from -x to x and get every pixel between the edges of the circle for this row.</p>
<p>Now that we had the width of the row we’re on and can iterate over each pixel, the next step is to determine what pixels we want to show and what pixels we want hidden. That is done in the following section of the function drawPlanet.</p>
<pre><code class="javascript language-javascript">    for (var x = -x1; x &lt; x1; x++) {
        var n = parseInt(Math.random() * x1) / 1.5;
        if (n &gt; x1 + x) {
            ctx.fillRect(x + xc, y + yc, 1, 1);
        }
    }
</code></pre>
<p>The variable n stores a random number between 0 and x1. Next to determine if we plot the point we check if n is greater than x1 + x. So points would only be plotted if n is greater than x+x1 meaning x *has* to cross the barrier, making it more likely points are plotted towards the end of our loop since x would be getting closer to x1 x+x1 would almost be double x1 making it very likely points will be ploted. If we just stopped there we would get a cool effect. Pixels would be randomly plotted for half of the planet. That is where the example in the commodore book ended. However I wanted to get a more spherical effect. All that we need to do for that is divide the value a bit.</p>
<pre><code class="javascript language-javascript">    var n = parseInt(Math.random() * x1) / 1.5;
</code></pre>
<p>I use a default of 1.5 what this does is decreases our random number generated even further making it less likely to plot points farther from the edge. And since the value of x1 follows the width of the circle as it goes down we get a cool spherical shading effect.</p>
<p>Below is an example of the shading you get with difference values for the divisor.</p>
<p><a href="http://www.somethinghitme.com/wp-content/uploads/2013/08/planet-phases.png"><img src="/src/blog/2013/08/16/3d-shading-with-points/images/planet-phases.png" alt="planet phases" /></a></p>
<p>And that's pretty much all there is to it. A pretty simple effect that uses some cool math and a bit of random to pull off.</p>
<iframe height="300" style="width: 100%;" scrolling="no" title="Planets with points" src="https://codepen.io/loktar00/embed/zEhDB?height=300&theme-id=690&default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true">
  See the Pen <a href='https://codepen.io/loktar00/pen/zEhDB'>Planets with points</a> by Loktar
  (<a href='https://codepen.io/loktar00'>@loktar00</a>) on <a href='https://codepen.io'>CodePen</a>.
</iframe>                    </section>
                    <hr/>
                    <footer>
                                            </footer>
                </article>
                <nav class="nav">
    <ul>
        <li><a class="link-button" rel="prev" href="/src/blog/2013/08/18/recreating-gifs-for-the-jsbin-compo/">← Recreating gifs for the jsBin Compo</a></li>        <li><a class="link-button" rel="prev" href="/src/blog/2013/06/20/atari-rom-reader-and-color-picker/">Atari Rom Reader, and color picker →</a></li>    </ul>
</nav>            </section>
            <section class="secondary">
                <aside class="aside-list">
            <h3>Find Me</h3>
            <ol>
                <li><a href="https://twitter.com/loktar00">@loktar00</a></li><li><a href="https://codepen.io/loktar00">Codepen</a></li><li><a href="https://github.com/loktar00">Github</a></li><li><a href="https://stackoverflow.com/users/322395/loktar">Stackoverflow</a></li><li><a href="https://www.dwitter.net/u/loktar">Dwitter</a></li>
            </ol>
        </aside><aside class="aside-list">
            <h3>Projects</h3>
            <ol>
                <li><a href="https://github.com/loktar00/react-lazy-load">react-lazy-load</a></li><li><a href="https://catbrownrealtor.com/">Cat Brown Realtor</a></li><li><a href="https://github.com/loktar00/jest">Jest Game Framework</a></li><li><a href="https://codegolf.stackexchange.com/questions/30322/make-it-look-like-im-working/30335#30335">gui hacker</a></li><li><a href="https://github.com/loktar00/JQuery-Snowfall">jQuery Snowfall</a></li><li><a href="http://www.retroships.com/">RetroShips</a></li><li><a href="https://zombiegames.net/">Zombiegames.net</a></li>
            </ol>
        </aside>            </section>
        </main>
        <footer class="footer">
    © 2023, Built by <a href="https://github.com/loktar00">Loktar</a>
</footer>    </div>
  </body>